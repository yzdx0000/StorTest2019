#!usr/bin/env python  
# -*- coding:utf-8 -*-
"""
:author: Liu he
:Description:
@file: 5-01-01-01.py
@time: 2018/11/01
"""

import os
import time
import json
import utils_path
import Lun_managerTest
import common
import common2
import commands
import breakdown
import log
import env_cache
import env_manage
import prepare_x1000
import get_config

'''初始化'''
file_name = os.path.basename(__file__)
file_name = file_name[:-3]  # 获取本脚本名，去掉.py后缀
log_file_path = log.get_log_path(file_name)  # 获取日志目录，即test_cases/Log/Case_log
log.init(log_file_path, True)
# env_cache.rel_check_before_run(file_name, jnl_rep=3, free_jnl_num=0, node_num=3)

conf_file = Lun_managerTest.CONF_FILE  # 配置文件路径
deploy_ips = get_config.get_env_ip_info(conf_file)  # 获取集群IP列表
client_ips = get_config.get_allclient_ip()  # 获取客户端IP

'''定义节点IP'''
node_ip1 = env_cache.deploy_ips[0]
client_ip = env_cache.client_ips[0]

# env_manage.create_iscsi_login()

lun_name = env_cache.osan.ls_scsi_dev(client_ip)
print lun_name
env_cache.analysis_xml_file(lun_name)

#
# def get_lun_size(c_ip=None, lun=None):
#     '''
#     :Usage : get lun's size
#     :param c_ip:
#     :param lun:
#     :return: int,unit:GB
#     '''
#     cmd = ("ssh %s \"fdisk -l %s 2> /dev/null | grep '%s'\"" % (c_ip, lun, lun))
#     (res, output) = commands.getstatusoutput(cmd)
#     if res != 0:
#         log.error("Get %s size failed." % (lun))
#         exit(1)
#     else:
#         test = output.split(" ")[1]
#         print test.split("：")[1]
#
#         #
#         # print type(string2)
#         # print type(str)
#         # print filter(str.isdigit, string2)
#         # test = output.decode("utf-8")
#         # print test
#         # print test.split(" ")
#         # return output
#
#
# get_lun_size(c_ip=client_ip, lun="/dev/sdb")
